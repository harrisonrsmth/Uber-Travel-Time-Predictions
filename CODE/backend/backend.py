from flask import Flask
from flask import request
import requests
import json
from flask_cors import CORS, cross_origin
from geopy.geocoders import Nominatim
import usaddress
import datetime
from math import radians, cos, sin, asin, sqrt

from uber_regression_nn_class import Uber_reg

app = Flask(__name__)
CORS(app)

'''
Test function to make sure flask connection to frontend works.

The remaining functions should not need the @app.route and @cross_origin() headers.

We will call the remaining functions from within this one.
'''

census_mapping = [('1', '023315'), ('2', '023421'), ('3', '021411'), ('4', '021416'), ('5', '021504'), ('6', '023419'), ('7', '050311'), ('8', '021906'), ('9', '006601'), ('10', '006700'), ('11', '009300'), ('12', '009402'), ('13', '010108'), ('14', '170602'), ('15', '010110'), ('16', '010205'), ('17', '010208'), ('18', '010507'), ('19', '010508'), ('20', '010512'), ('21', '010601'), ('22', '010603'), ('23', '010604'), ('24', '030330'), ('25', '031311'), ('26', '031404'), ('27', '031405'), ('28', '031406'), ('29', '031503'), ('30', '031505'), ('31', '010122'), ('32', '030331'), ('33', '030332'), ('34', '030333'), ('35', '130613'), ('36', '031001'), ('37', '030320'), ('38', '030502'), ('39', '030322'), ('40', '031307'), ('41', '030319'), ('42', '031101'), ('43', '030318'), ('44', '030336'), ('45', '030504'), ('46', '031110'), ('47', '030101'), ('48', '030103'), ('49', '030328'), ('50', '030209'), ('51', '030214'), ('52', '030215'), ('53', '030334'), ('54', '030335'), ('55', '030337'), ('56', '030339'), ('57', '030310'), ('58', '030311'), ('59', '030312'), ('60', '030104'), ('61', '030313'), ('62', '030405'), ('63', '030314'), ('64', '030505'), ('65', '030700'), ('66', '030324'), ('67', '030800'), ('68', '030901'), ('69', '030902'), ('70', '030904'), ('71', '030905'), ('72', '030326'), ('73', '031002'), ('74', '031004'), ('75', '031005'), ('76', '021912'), ('77', '031106'), ('78', '030327'), ('79', '031108'), ('80', '031111'), ('81', '031112'), ('82', '030329'), ('83', '031306'), ('84', '031308'), ('85', '031309'), ('86', '031310'), ('87', '021405'), ('88', '021909'), ('89', '022001'), ('90', '022004'), ('91', '022005'), ('92', '022008'), ('93', '023507'), ('94', '023602'), ('95', '023603'), ('96', '021502'), ('97', '021602'), ('98', '021603'), ('99', '021703'), ('100', '022401'), ('101', '022402'), ('102', '022403'), ('103', '022500'), ('104', '023700'), ('105', '021704'), ('106', '021705'), ('107', '021706'), ('108', '021805'), ('109', '022600'), ('110', '022700'), ('111', '023501'), ('112', '021907'), ('113', '000500'), ('114', '001300'), ('115', '001400'), ('116', '001500'), ('117', '001600'), ('118', '001800'), ('119', '001900'), ('120', '003600'), ('121', '910703'), ('122', '910800'), ('123', '010002'), ('124', '010001'), ('125', '009802'), ('126', '006801'), ('127', '910701'), ('128', '910702'), ('129', '910200'), ('130', '910101'), ('131', '009700'), ('132', '010210'), ('133', '010209'), ('134', '010107'), ('135', '010301'), ('136', '002500'), ('137', '010304'), ('138', '007100'), ('139', '010513'), ('140', '010510'), ('141', '007200'), ('142', '006200'), ('143', '001100'), ('144', '007300'), ('145', '004200'), ('146', '009101'), ('147', '008904'), ('148', '011611'), ('149', '011617'), ('150', '003700'), ('151', '010511'), ('152', '011504'), ('153', '011615'), ('154', '011503'), ('155', '011423'), ('156', '011425'), ('157', '011613'), ('158', '011420'), ('159', '011620'), ('160', '011614'), ('161', '011621'), ('162', '011619'), ('163', '011623'), ('164', '010211'), ('165', '011622'), ('166', '012000'), ('167', '000600'), ('168', '001700'), ('169', '009000'), ('170', '007002'), ('171', '009900'), ('172', '010303'), ('173', '010514'), ('174', '011000'), ('175', '000100'), ('176', '000200'), ('177', '000400'), ('178', '050212'), ('179', '050210'), ('180', '050606'), ('181', '050525'), ('182', '050214'), ('183', '050220'), ('184', '050531'), ('185', '050723'), ('186', '050544'), ('187', '050537'), ('188', '050607'), ('189', '050608'), ('190', '050546'), ('191', '050548'), ('192', '050724'), ('193', '050523'), ('194', '050728'), ('195', '050216'), ('196', '050431'), ('197', '110100'), ('198', '160300'), ('199', '160100'), ('200', '160600'), ('201', '160200'), ('202', '160400'), ('203', '160500'), ('204', '960700'), ('205', '960803'), ('206', '960802'), ('207', '960801'), ('208', '080602'), ('209', '110602'), ('210', '110505'), ('211', '110508'), ('212', '110603'), ('213', '110506'), ('214', '110507'), ('215', '110601'), ('216', '091006'), ('217', '091101'), ('218', '140304'), ('219', '140307'), ('220', '140404'), ('221', '140405'), ('222', '140403'), ('223', '140502'), ('224', '140501'), ('225', '140408'), ('226', '140407'), ('227', '140102'), ('228', '140406'), ('229', '140303'), ('230', '140101'), ('231', '140203'), ('232', '140306'), ('233', '140204'), ('234', '140206'), ('235', '140305'), ('236', '002900'), ('237', '010206'), ('238', '010106'), ('239', '010204'), ('240', '006602'), ('241', '090802'), ('242', '011624'), ('243', '091103'), ('244', '090602'), ('245', '091003'), ('246', '090601'), ('247', '090701'), ('248', '090702'), ('249', '091102'), ('250', '090300'), ('251', '090902'), ('252', '091001'), ('253', '090502'), ('254', '090901'), ('255', '080505'), ('256', '080506'), ('257', '080507'), ('258', '040614'), ('259', '040518'), ('260', '040612'), ('261', '023418'), ('262', '023803'), ('263', '091008'), ('264', '090804'), ('265', '090803'), ('266', '090904'), ('267', '090905'), ('268', '040302'), ('269', '091007'), ('270', '040303'), ('271', '040608'), ('272', '040410'), ('273', '040611'), ('274', '040202'), ('275', '040413'), ('276', '040512'), ('277', '040409'), ('278', '040407'), ('279', '040408'), ('280', '040411'), ('281', '022100'), ('282', '023801'), ('283', '040412'), ('284', '040509'), ('285', '040510'), ('286', '070110'), ('287', '070111'), ('288', '070309'), ('289', '070204'), ('290', '070404'), ('291', '070502'), ('292', '070307'), ('293', '070403'), ('294', '040513'), ('295', '040514'), ('296', '040515'), ('297', '040516'), ('298', '100600'), ('299', '100700'), ('300', '100502'), ('301', '100100'), ('302', '100800'), ('303', '100400'), ('304', '100300'), ('305', '040606'), ('306', '040609'), ('307', '040613'), ('308', '030218'), ('309', '031205'), ('310', '030224'), ('311', '031209'), ('312', '031207'), ('313', '031208'), ('314', '030507'), ('315', '030506'), ('316', '030601'), ('317', '060404'), ('318', '060308'), ('319', '060403'), ('320', '060306'), ('321', '060305'), ('322', '060405'), ('323', '060101'), ('324', '060202'), ('325', '060406'), ('326', '060304'), ('327', '060102'), ('328', '060407'), ('329', '060309'), ('330', '060307'), ('331', '060201'), ('332', '011417'), ('333', '011506'), ('334', '011416'), ('335', '011421'), ('336', '011426'), ('337', '011610'), ('338', '011618'), ('339', '011625'), ('340', '011612'), ('341', '007705'), ('342', '009601'), ('343', '009603'), ('344', '009801'), ('345', '010119'), ('346', '010121'), ('347', '010123'), ('348', '120400'), ('349', '120202'), ('350', '050308'), ('351', '050306'), ('352', '050309'), ('353', '050310'), ('354', '050313'), ('355', '022800'), ('356', '022900'), ('357', '021412'), ('358', '023601'), ('359', '021307'), ('360', '021102'), ('361', '021415'), ('362', '021417'), ('363', '021305'), ('364', '050314'), ('365', '011505'), ('366', '011422'), ('367', '011424'), ('368', '011626'), ('369', '011900'), ('370', '023000'), ('371', '023101'), ('372', '023102'), ('373', '021306'), ('374', '021308'), ('375', '021605'), ('376', '021913'), ('377', '022009'), ('378', '022203'), ('379', '080102'), ('380', '012300'), ('381', '023214'), ('382', '023313'), ('383', '023316'), ('384', '021101'), ('385', '023107'), ('386', '023108'), ('387', '023204'), ('388', '021414'), ('389', '021215'), ('390', '050417'), ('391', '050304'), ('392', '110503'), ('393', '110504'), ('394', '021217'), ('395', '021409'), ('396', '021814'), ('397', '023111'), ('398', '022010'), ('399', '023113'), ('400', '023206'), ('401', '023208'), ('402', '023209'), ('403', '023210'), ('404', '023211'), ('405', '050712'), ('406', '050105'), ('407', '050429'), ('408', '050423'), ('409', '050205'), ('410', '050106'), ('411', '050415'), ('412', '050421'), ('413', '050718'), ('414', '050709'), ('415', '050714'), ('416', '050721'), ('417', '050103'), ('418', '023115'), ('419', '023314'), ('420', '023422'), ('421', '023424'), ('422', '023427'), ('423', '021202'), ('424', '021204'), ('425', '010800'), ('426', '011418'), ('427', '009102'), ('428', '001202'), ('429', '023212'), ('430', '023303'), ('431', '023309'), ('432', '023310'), ('433', '080509'), ('434', '080604'), ('435', '080103'), ('436', '021413'), ('437', '020802'), ('438', '021911'), ('439', '021216'), ('440', '021410'), ('441', '021503'), ('442', '001201'), ('443', '001001'), ('444', '008903'), ('445', '004300'), ('446', '980000'), ('447', '011616'), ('448', '080303'), ('449', '080304'), ('450', '021208'), ('451', '021209'), ('452', '080603'), ('453', '080508'), ('454', '021210'), ('455', '021211'), ('456', '021806'), ('457', '021808'), ('458', '021810'), ('459', '023410'), ('460', '023411'), ('461', '023412'), ('462', '023413'), ('463', '021604'), ('464', '021910'), ('465', '023112'), ('466', '023114'), ('467', '023213'), ('468', '050315'), ('469', '011427'), ('470', '007603'), ('471', '007704'), ('472', '007604'), ('473', '007703'), ('474', '021213'), ('475', '021214'), ('476', '021301'), ('477', '021303'), ('478', '021812'), ('479', '023311'), ('480', '023312'), ('481', '021908'), ('482', '023414'), ('483', '023504'), ('484', '023505'), ('485', '023506'), ('486', '022204'), ('487', '023426'), ('488', '007706'), ('489', '011306'), ('490', '011305'), ('491', '050410'), ('492', '050416'), ('493', '050418'), ('494', '009501'), ('495', '120501'), ('496', '120601'), ('497', '120104'), ('498', '050422'), ('499', '050424'), ('500', '050425'), ('501', '050426'), ('502', '050419'), ('503', '050428'), ('504', '050430'), ('505', '021809'), ('506', '020700'), ('507', '050511'), ('508', '050520'), ('509', '050521'), ('510', '050522'), ('511', '050715'), ('512', '031114'), ('513', '031313'), ('514', '031312'), ('515', '031506'), ('516', '030219'), ('517', '030220'), ('518', '031206'), ('519', '030226'), ('520', '170403'), ('521', '170603'), ('522', '170501'), ('523', '170503'), ('524', '170304'), ('525', '030229'), ('526', '030602'), ('527', '050719'), ('528', '050720'), ('529', '050427'), ('530', '050713'), ('531', '170306'), ('532', '170502'), ('533', '170305'), ('534', '080201'), ('535', '080202'), ('536', '080301'), ('537', '080402'), ('538', '050540'), ('539', '050211'), ('540', '050219'), ('541', '050319'), ('542', '050526'), ('543', '910104'), ('544', '910103'), ('545', '070106'), ('546', '070304'), ('547', '070306'), ('548', '070402'), ('549', '008902'), ('550', '070305'), ('551', '070203'), ('552', '070202'), ('553', '070104'), ('554', '031211'), ('555', '031212'), ('556', '030227'), ('557', '080403'), ('558', '080404'), ('559', '080511'), ('560', '080510'), ('561', '130604'), ('562', '130508'), ('563', '130602'), ('564', '130607'), ('565', '130611'), ('566', '130610'), ('567', '130603'), ('568', '130509'), ('569', '130410'), ('570', '130510'), ('571', '130601'), ('572', '130404'), ('573', '130302'), ('574', '130608'), ('575', '130406'), ('576', '130306'), ('577', '130304'), ('578', '130307'), ('579', '050527'), ('580', '050107'), ('581', '050209'), ('582', '050436'), ('583', '050542'), ('584', '050726'), ('585', '050545'), ('586', '130612'), ('587', '130305'), ('588', '130605'), ('589', '130609'), ('590', '130606'), ('591', '023428'), ('592', '009502'), ('593', '009602'), ('594', '009404'), ('595', '009403'), ('596', '010212'), ('597', '010114'), ('598', '010115'), ('599', '010113'), ('600', '010118'), ('601', '010117'), ('602', '070108'), ('603', '070311'), ('604', '070107'), ('605', '070205'), ('606', '070501'), ('607', '030340'), ('608', '030343'), ('609', '010120'), ('610', '010516'), ('611', '010515'), ('612', '011419'), ('613', '070109'), ('614', '070114'), ('615', '070310'), ('616', '070113'), ('617', '011800'), ('618', '030228'), ('619', '030230'), ('620', '030231'), ('621', '040306'), ('622', '050549'), ('623', '050108'), ('624', '050109'), ('625', '050208'), ('626', '050213'), ('627', '050605'), ('628', '040416'), ('629', '040525'), ('630', '050528'), ('631', '050538'), ('632', '050530'), ('633', '050529'), ('634', '040526'), ('635', '040308'), ('636', '040204'), ('637', '040414'), ('638', '040521'), ('639', '050217'), ('640', '050218'), ('641', '050317'), ('642', '050320'), ('643', '050318'), ('644', '050215'), ('645', '040615'), ('646', '040617'), ('647', '040203'), ('648', '040417'), ('649', '040520'), ('650', '040522'), ('651', '040523'), ('652', '050322'), ('653', '050321'), ('654', '050434'), ('655', '050432'), ('656', '040621'), ('657', '040622'), ('658', '050433'), ('659', '050533'), ('660', '050435'), ('661', '050534'), ('662', '050532'), ('663', '030106'), ('664', '030107'), ('665', '031408'), ('666', '031409'), ('667', '050535'), ('668', '050539'), ('669', '050536'), ('670', '050727'), ('671', '030413'), ('672', '030414'), ('673', '030412'), ('674', '170303'), ('675', '170404'), ('676', '170405'), ('677', '170601'), ('678', '170406'), ('679', '030341'), ('680', '030342'), ('681', '030409'), ('682', '030410'), ('683', '030408'), ('684', '030407'), ('685', '030236'), ('686', '030238'), ('687', '030239'), ('688', '040524'), ('689', '040616'), ('690', '040620'), ('691', '040415'), ('692', '040519'), ('693', '040619'), ('694', '980000'), ('695', '030411'), ('696', '030344'), ('697', '030345'), ('698', '031113'), ('699', '050543'), ('700', '050547'), ('701', '050524'), ('702', '050541'), ('703', '031509'), ('704', '030223'), ('705', '031115'), ('706', '031116'), ('707', '031508'), ('708', '031507'), ('709', '031117'), ('710', '031118'), ('711', '030222'), ('712', '030232'), ('713', '030233'), ('714', '030234'), ('715', '030235'), ('716', '050730'), ('717', '050725'), ('718', '050729'), ('719', '050722'), ('720', '050731'), ('721', '011100'), ('722', '011201'), ('723', '011202'), ('724', '100501'), ('725', '100901'), ('726', '100902'), ('727', '100903'), ('728', '011301'), ('729', '011303'), ('730', '120302'), ('731', '120103'), ('732', '120102'), ('733', '120303'), ('734', '120301'), ('735', '120204'), ('736', '120602'), ('737', '120605'), ('738', '120503'), ('739', '120502'), ('740', '120101'), ('741', '120203'), ('742', '120603'), ('743', '120604'), ('744', '140208'), ('745', '140207'), ('746', '011405'), ('747', '011410'), ('748', '011411'), ('749', '011414'), ('750', '020400'), ('751', '020500'), ('752', '020600'), ('753', '020801'), ('754', '020900'), ('755', '001002'), ('756', '000700'), ('757', '008700'), ('758', '023416'), ('759', '023802'), ('760', '022301'), ('761', '023306'), ('762', '020100'), ('763', '022302'), ('764', '022007'), ('765', '020200'), ('766', '020300'), ('767', '023423'), ('768', '023425'), ('769', '006802'), ('770', '006900'), ('771', '007001'), ('772', '007400'), ('773', '010400'), ('774', '011412'), ('775', '021813'), ('776', '021218'), ('777', '007602'), ('778', '002100'), ('779', '002300'), ('780', '007802'), ('781', '007805'), ('782', '007806'), ('783', '002400'), ('784', '002600'), ('785', '002800'), ('786', '003000'), ('787', '003100'), ('788', '003200'), ('789', '003500'), ('790', '003800'), ('791', '007807'), ('792', '007808'), ('793', '007900'), ('794', '008000'), ('795', '008102'), ('796', '008201'), ('797', '004000'), ('798', '004100'), ('799', '004400'), ('800', '004800'), ('801', '003900'), ('802', '004900'), ('803', '005000'), ('804', '005200'), ('805', '005300'), ('806', '008202'), ('807', '008301'), ('808', '008302'), ('809', '008400'), ('810', '008500'), ('811', '008601'), ('812', '005501'), ('813', '005502'), ('814', '005700'), ('815', '005800'), ('816', '006100'), ('817', '006300'), ('818', '006400'), ('819', '006500'), ('820', '008602'), ('821', '008800'), ('822', '009200'), ('823', '091005'), ('824', '007500'), ('825', '040307'), ('826', '170100'), ('827', '170200'), ('828', '170402'), ('829', '006000'), ('830', '008101'), ('831', '980000')]

coordinate_mapping = {'1': [33.75347116720257, -84.08282330868165], '2': [33.679735717741934, -84.25213010215053], '3': [33.86608465151515, -84.32889783333331], '4': [33.84757107246377, -84.33400602898551], '5': [33.80661484, -84.32431584307692], '6': [33.65783477631579, -84.21655484868421], '7': [33.947821656441725, -84.2131123435583], '8': [33.79800291538462, -84.17874724615386], '9': [33.71148611594203, -84.42321927536231], '10': [33.70836664285714, -84.38962737857142], '11': [33.81961017159763, -84.38034018934911], '12': [33.8215887133758, -84.36281180254777], '13': [33.9687164982699, -84.28157673702422], '14': [33.371264591836734, -84.73491698639455], '15': [33.92120049166667, -84.36518741666667], '16': [33.93336095067265, -84.38915540358744], '17': [33.988841518644065, -84.36693167796611], '18': [33.60686589032258, -84.48148630322581], '19': [33.59211701612903, -84.48075104838712], '20': [33.59048420754717, -84.53592789150943], '21': [33.662656763440864, -84.4594089032258], '22': [33.64512143502825, -84.47024281920905], '23': [33.6305416625, -84.4745276875], '24': [33.99110370881226, -84.46903857854407], '25': [33.78591813065326, -84.56378442713569], '26': [33.8364802371134, -84.6050835927835], '27': [33.87277482291667, -84.60973969270833], '28': [33.85434703378378, -84.60434891216217], '29': [33.886972791304345, -84.63680482608694], '30': [33.861538432038834, -84.68342284466019], '31': [33.95696759689922, -84.34827044186046], '32': [34.00082858222222, -84.45018459111112], '33': [33.986477435714285, -84.44326449285714], '34': [33.962659428571435, -84.44660423963134], '35': [34.13313240540541, -84.18633655405404], '36': [33.917228642622945, -84.52191168196721], '37': [33.922599402941174, -84.44847283235293], '38': [33.9870739, -84.51442962222222], '39': [34.04626518232044, -84.4442014033149], '40': [33.83663616722408, -84.5557261438127], '41': [33.97257188432836, -84.38926254104479], '42': [33.890748571428574, -84.52706477777775], '43': [33.943439015974434, -84.43726776038338], '44': [33.99328060646901, -84.40981519137468], '45': [33.97677906600661, -84.50328228382838], '46': [33.877190934426224, -84.52449334426231], '47': [34.036592056149736, -84.69775475668449], '48': [34.053684932400934, -84.66051742890443], '49': [34.019879238853505, -84.42669850955414], '50': [33.93538727777778, -84.6400992962963], '51': [34.01621760176992, -84.66018942920356], '52': [34.00987045673077, -84.63452478846153], '53': [33.969794737804875, -84.42765609146342], '54': [34.008595818867924, -84.41168177358492], '55': [33.98179360784314, -84.40016380882352], '56': [33.88504388669951, -84.4503371231527], '57': [34.065492211920535, -84.5405329205298], '58': [34.052525573770495, -84.50264339754098], '59': [34.030015391891894, -84.51150394144145], '60': [34.07028988435375, -84.67253253061224], '61': [34.034277219387754, -84.54061941836736], '62': [33.936952406593406, -84.49050447802198], '63': [34.0304397631579, -84.48468406390978], '64': [33.9646141125, -84.50746741875], '65': [33.961242586776855, -84.53990782644627], '66': [34.06840305797101, -84.50177672463768], '67': [33.936877461847395, -84.52722475100401], '68': [33.93547781990521, -84.58252729383887], '69': [33.939446582524276, -84.56003467961165], '70': [33.92175752777778, -84.56628713888888], '71': [33.904543227272725, -84.59108676363637], '72': [34.062187816176476, -84.44561336764706], '73': [33.90712242608695, -84.56311981739132], '74': [33.89043501875, -84.55767661875], '75': [33.891779410256405, -84.57848575641026], '76': [33.83596663020833, -84.16455903645834], '77': [33.861124873076925, -84.57395293461538], '78': [34.02381097073171, -84.45832392195122], '79': [33.89601383428571, -84.51144994857142], '80': [33.879393161290324, -84.50084032258066], '81': [33.86677536974789, -84.50579999159665], '82': [33.997426213636366, -84.48260721363637], '83': [33.826538696202526, -84.59069219620254], '84': [33.80328161142857, -84.58417391999998], '85': [33.798828556701025, -84.5975827628866], '86': [33.77530411023622, -84.57996353543308], '87': [33.85713177717391, -84.32766175543479], '88': [33.792952892857144, -84.20901191666667], '89': [33.818723000000006, -84.25177484615385], '90': [33.80683652892562, -84.21868700000002], '91': [33.790887877094974, -84.2295332122905], '92': [33.80306729591837, -84.23552482653062], '93': [33.72316207947019, -84.22468662913909], '94': [33.723551, -84.29705864646463], '95': [33.720427083333334, -84.29017779166666], '96': [33.81564789781022, -84.33860832846716], '97': [33.81642713953488, -84.29651747286822], '98': [33.826588174825176, -84.31681120979022], '99': [33.84464193401015, -84.27335830456853], '100': [33.79042128651685, -84.33791846067415], '101': [33.79963195736435, -84.32429375581395], '102': [33.780169730593606, -84.32164778995433], '103': [33.776767383333336, -84.30793970833332], '104': [33.733387674876845, -84.3182646502463], '105': [33.83281664478765, -84.26513210038611], '106': [33.876940595959596, -84.26026755050505], '107': [33.86355827385892, -84.26666778423237], '108': [33.83380332022472, -84.22007764044943], '109': [33.78363931355933, -84.2936418474576], '110': [33.758698734375, -84.30473478124999], '111': [33.73500681967213, -84.26960281967213], '112': [33.80108953310104, -84.14136366550522], '113': [33.79575855932203, -84.38413080225989], '114': [33.7755299, -84.3702017], '115': [33.77598285714286, -84.36250214285714], '116': [33.77712501694916, -84.35358076271187], '117': [33.76606918644068, -84.35720991525422], '118': [33.76504285714285, -84.3793612857143], '119': [33.766876559322036, -84.38862211864404], '120': [33.752487, -84.4008901707317], '121': [33.63313208232445, -85.01654735108959], '122': [33.510370866477274, -84.9461473465909], '123': [33.874939117834394, -84.35851065605095], '124': [33.868392226053636, -84.37228253639847], '125': [33.87021479665738, -84.42767313927577], '126': [33.710124725, -84.3686112], '127': [33.579520320987655, -84.98689590476191], '128': [33.60752368764569, -84.9476022144522], '129': [33.70811291009464, -85.03215027287067], '130': [33.73342644525547, -84.92059328832117], '131': [33.83412933819242, -84.43907871137026], '132': [33.950234934027776, -84.38418838194444], '133': [33.973396906976745, -84.36802340697675], '134': [33.97749477029703, -84.30032365346534], '135': [33.625075774942, -84.63157075406032], '136': [33.75868803846154, -84.41235303846155], '137': [33.65086725149701, -84.56489885828344], '138': [33.69241277083333, -84.35710934027777], '139': [33.598905686722, -84.5578671099585], '140': [33.5562248410959, -84.52876346027398], '141': [33.667455922290394, -84.3672040981595], '142': [33.72858581818182, -84.42119375757576], '143': [33.78359522222222, -84.38207383333332], '144': [33.670115062378166, -84.37064153996103], '145': [33.738034075471695, -84.41620394339623], '146': [33.81064934700316, -84.39903059305995], '147': [33.82355437171053, -84.43647372697369], '148': [34.05223334977578, -84.31445810089687], '149': [34.043669688836104, -84.25452340617576], '150': [33.74794156, -84.40988255999999], '151': [33.616589136518776, -84.5152032764505], '152': [34.146134182587666, -84.31537702539299], '153': [34.11855011076443, -84.29045994227768], '154': [34.107452181588904, -84.36440872761665], '155': [34.01811545637584, -84.38956761409396], '156': [34.007871648318044, -84.24489510397552], '157': [34.03322614126394, -84.21251087360595], '158': [34.02997337681158, -84.32608453623189], '159': [34.07404968025079, -84.220393677116], '160': [34.09848320361991, -84.27097765610861], '161': [34.088276336917566, -84.22874648028674], '162': [34.063142115107915, -84.24520375539569], '163': [34.04157260627178, -84.19503567247386], '164': [33.88115221705426, -84.397232251938], '165': [34.049305578723406, -84.14538277446808], '166': [33.73532913513513, -84.3935575], '167': [33.78585407692307, -84.40643128571428], '168': [33.76543845454545, -84.36595972727272], '169': [33.81476386857143, -84.40839796571429], '170': [33.690278904761904, -84.36333974761905], '171': [33.858755746875, -84.39597534375], '172': [33.700361, -84.56203117777778], '173': [33.58912087238096, -84.60672030476191], '174': [33.674833142857146, -84.42812690909092], '175': [33.79544545454545, -84.35609486776858], '176': [33.79620840566038, -84.36455665094338], '177': [33.791214780487806, -84.37889892682928], '178': [34.05914251041666, -84.10114296354168], '179': [34.03438847453703, -84.08235460879631], '180': [34.09298435492958, -83.95189448450704], '181': [34.004276047619044, -84.02233752795031], '182': [34.0274290625, -84.12030694153226], '183': [33.99016409941521, -84.18267877777778], '184': [33.90239185365853, -84.07967021951218], '185': [33.821022043333336, -84.06439383333333], '186': [33.915970641447366, -84.01989576315789], '187': [33.956233000000005, -84.09514806451614], '188': [34.003898609504134, -83.92125653512397], '189': [33.95694631731731, -83.87411303253253], '190': [33.93046807462687, -83.92284625522389], '191': [33.99966174193548, -83.951282062724], '192': [33.876857472527476, -83.9621129532967], '193': [33.98558060152285, -84.00407530203044], '194': [33.802544386217946, -84.01213717307692], '195': [34.01696927244583, -84.09172960371518], '196': [33.874543945736434, -84.18675372480621], '197': [33.8890038923611, -83.71622917361111], '198': [33.28963049248121, -84.25870943984962], '199': [33.324459252158896, -84.3450619343696], '200': [33.24244040956651, -84.44853947608371], '201': [33.293198398437504, -84.1547774140625], '202': [33.27052514705882, -84.27147486764704], '203': [33.27723351623377, -84.31695583441558], '204': [34.186335396681756, -84.7474951055807], '205': [34.11418092512078, -84.77635321014493], '206': [34.115996760667905, -84.69350671985158], '207': [34.12460668045113, -84.68756568984962], '208': [33.73351227348643, -84.63829566179541], '209': [33.72052985844156, -83.7672123012987], '210': [33.86513844117647, -83.82664249673202], '211': [33.81053645021645, -83.83889435064934], '212': [33.755079682403434, -83.88439593991417], '213': [33.78349101204819, -83.9210223815261], '214': [33.80046910320285, -83.89549031672598], '215': [33.783314873376625, -83.80473462012988], '216': [34.12020665333333, -84.56899558666667], '217': [34.1441606981982, -84.60083777027027], '218': [33.402654043824704, -84.552450187251], '219': [33.350319202806126, -84.51773853188774], '220': [33.440261491228064, -84.48788163937621], '221': [33.4041772305026, -84.48486129289428], '222': [33.473404312977095, -84.48385020356234], '223': [33.29338322213562, -84.46981463289167], '224': [33.352722635276535, -84.44008338041853], '225': [33.39993964272212, -84.40252924385634], '226': [33.43897253828828, -84.41106139639639], '227': [33.49397930756579, -84.47335958223685], '228': [33.46748572098765, -84.40766168641974], '229': [33.37360131698113, -84.58406303144655], '230': [33.51799807876713, -84.50322338527397], '231': [33.486474609436435, -84.59889670904325], '232': [33.34899933980582, -84.54896743689321], '233': [33.48200315322581, -84.53106676612903], '234': [33.4370515359116, -84.56951954143646], '235': [33.41374095129376, -84.50656191780823], '236': [33.75800415625, -84.3685918125], '237': [33.89045021926229, -84.42140480737704], '238': [33.981385277419356, -84.32478181290323], '239': [33.93047283102493, -84.41100442936288], '240': [33.71782157142858, -84.42960935714287], '241': [34.16262388306943, -84.3738926540804], '242': [34.075292876288664, -84.19004730927836], '243': [34.106915727678576, -84.62421615178573], '244': [34.22467081344902, -84.44254402603036], '245': [34.090542985401456, -84.57085063868612], '246': [34.21529036017897, -84.49414039821029], '247': [34.163470816, -84.52491997399999], '248': [34.166207456375844, -84.49163091275169], '249': [34.098209758278145, -84.59487026821192], '250': [34.236369453598485, -84.55849828882576], '251': [34.0962729122807, -84.45385773684211], '252': [34.112726309322035, -84.5190721101695], '253': [34.221738946577624, -84.34900282470784], '254': [34.11835238650307, -84.44684387218813], '255': [33.70988906741573, -84.786682752809], '256': [33.68276949673202, -84.80785827450981], '257': [33.6455612662037, -84.78658302546297], '258': [33.5205104375, -84.30787060267858], '259': [33.50629905982906, -84.38901313461538], '260': [33.52066146244132, -84.3681418262911], '261': [33.65892693125, -84.14211490833333], '262': [33.70614551015802, -84.31735543566592], '263': [34.12823658565736, -84.54494152988048], '264': [34.13793101349831, -84.45212584701913], '265': [34.174089384259254, -84.45096221064814], '266': [34.1050665, -84.49019101302083], '267': [34.082301673267324, -84.5042890891089], '268': [33.63274555479452, -84.37358597260274], '269': [34.14094099173554, -84.56570854958676], '270': [33.63699801413427, -84.34360360070671], '271': [33.40702109651163, -84.38195556627906], '272': [33.62964449363867, -84.32303737659034], '273': [33.54755293142857, -84.37300874571429], '274': [33.605322881012654, -84.40829382784811], '275': [33.56964599135447, -84.28862138616714], '276': [33.569972891891894, -84.4278486036036], '277': [33.59029972380952, -84.30516266666666], '278': [33.607673610619464, -84.3391954336283], '279': [33.59205783040936, -84.33721915789474], '280': [33.60167282648402, -84.27802370319635], '281': [33.78907660185185, -84.25566619444444], '282': [33.71323909785933, -84.33935796941896], '283': [33.56965722972973, -84.32826396621621], '284': [33.586980870503595, -84.44868669784171], '285': [33.58876746706587, -84.4300817245509], '286': [33.585602196759254, -84.18997853240741], '287': [33.532380576036864, -84.23748686635945], '288': [33.50251249270073, -84.20096296350364], '289': [33.560854874074074, -84.15359738024691], '290': [33.32986495448276, -84.12457267724137], '291': [33.39120124655648, -84.22755703443526], '292': [33.473990855130786, -84.14025590140847], '293': [33.37619668199234, -84.08279175670498], '294': [33.55973789552239, -84.43451750746269], '295': [33.537843330769235, -84.43112373846152], '296': [33.53268057425743, -84.40675007920792], '297': [33.530705187250994, -84.3821751195219], '298': [33.55003033333333, -83.89264051587301], '299': [33.562821703488375, -83.86431017441859], '300': [33.58813883153639, -83.90809711725066], '301': [33.66288663454411, -83.87199550185322], '302': [33.467759323019216, -83.87618553774028], '303': [33.611816815724815, -83.87193518427519], '304': [33.5700915582269, -83.82570094064613], '305': [33.46583551977401, -84.31598462146893], '306': [33.54318243778802, -84.3286230967742], '307': [33.508492661087864, -84.31696345606694], '308': [33.98564393636364, -84.65250752727273], '309': [33.83936642439024, -84.4777135902439], '310': [34.03948035204081, -84.63929713775508], '311': [33.855386209302324, -84.49602737790697], '312': [33.8725405338983, -84.46497866949153], '313': [33.87278917272727, -84.48648379090908], '314': [34.00990063975156, -84.5160661242236], '315': [34.000425257281556, -84.53776371844661], '316': [33.99674377647059, -84.56611317058825], '317': [33.60627373790322, -84.0240931875], '318': [33.67774549429657, -83.99339343346007], '319': [33.61722909563994, -84.11734222222222], '320': [33.64367607011071, -83.95881877490774], '321': [33.66095554242424, -83.97202616969697], '322': [33.56299166983825, -84.08583364985728], '323': [33.71727407989691, -84.01045395360825], '324': [33.644712158774375, -84.06245686350975], '325': [33.581701464539, -84.01461137943262], '326': [33.65465671868583, -84.02917190143738], '327': [33.702283693137254, -83.9417391254902], '328': [33.56932262621359, -84.01422781553399], '329': [33.68825688888889, -84.02093963398693], '330': [33.60608904891304, -83.99530458695652], '331': [33.699864152046786, -84.04574118128654], '332': [34.056490735, -84.365884235], '333': [34.078956796791445, -84.39718926737967], '334': [34.06372036637931, -84.33878164224139], '335': [34.04632975252526, -84.32894778282828], '336': [34.03954416170213, -84.24264871489362], '337': [34.0815549375, -84.31275425568182], '338': [34.05678189912281, -84.25378724561403], '339': [34.031898233449475, -84.20235881533101], '340': [34.00450463250884, -84.20131914487632], '341': [33.68719576829268, -84.48994368292685], '342': [33.845556699999996, -84.37872126666666], '343': [33.83415126041667, -84.37525939583334], '344': [33.831726255813955, -84.41720720930232], '345': [33.99352977358491, -84.34461253773586], '346': [33.931470778846155, -84.37109337500002], '347': [33.945260570370365, -84.36541107407407], '348': [33.873340166539926, -84.90578551558936], '349': [33.906660547445256, -84.75506444525547], '350': [33.98635746464647, -84.220050510101], '351': [33.930219033980585, -84.22931445145632], '352': [33.98243547173913, -84.19322751086956], '353': [33.96207856680162, -84.24437118218624], '354': [33.94248815238095, -84.1780958], '355': [33.758032501886795, -84.28696023773584], '356': [33.75789130167598, -84.28247658379888], '357': [33.86950561363636, -84.315043], '358': [33.73533996842106, -84.29986228421053], '359': [33.89016647297297, -84.27437993243242], '360': [33.870175578431365, -84.33961974509802], '361': [33.83940791304347, -84.34335546956521], '362': [33.840281133333335, -84.33342350476191], '363': [33.93488738888889, -84.27736221111111], '364': [33.953145444444445, -84.16166186324786], '365': [34.081146218978105, -84.37179084671533], '366': [34.00126636437247, -84.37618697570849], '367': [34.00525943062201, -84.26298657894738], '368': [34.061651681818184, -84.18722823484848], '369': [33.753481075, -84.38076985000001], '370': [33.768293603305786, -84.26823288429753], '371': [33.74414504651163, -84.27392874418605], '372': [33.76323147413793, -84.26024097413796], '373': [33.91985071774193, -84.27959231451614], '374': [33.87290504424779, -84.28913507079645], '375': [33.848513450819674, -84.29550863934425], '376': [33.82028088571428, -84.18110436190474], '377': [33.81882150515464, -84.23376925773196], '378': [33.786070064935075, -84.27687657142856], '379': [33.75137182532751, -84.6267866135371], '380': [33.660254981818184, -84.43946813636363], '381': [33.715594005263156, -84.18876612105262], '382': [33.736252455445545, -84.1339327821782], '383': [33.77725138011696, -84.08822597076025], '384': [33.888461709090905, -84.33570910909089], '385': [33.750473109375, -84.249656], '386': [33.74696994736842, -84.23629773026316], '387': [33.77525948679245, -84.21135665660378], '388': [33.84706895348838, -84.31879986046512], '389': [33.930562786885254, -84.33807332786886], '390': [33.90311340776699, -84.21972869902912], '391': [33.93105259602649, -84.25195813907285], '392': [33.82909812017167, -83.80271480257511], '393': [33.84118090265487, -83.87338488495575], '394': [33.92694666666666, -84.29007087387389], '395': [33.86197841919192, -84.29677797474749], '396': [33.891265821656056, -84.23460708917197], '397': [33.76247816528926, -84.2240502644628], '398': [33.81261629032257, -84.23182970967744], '399': [33.778962401574795, -84.24934938582678], '400': [33.74966684126984, -84.20829807936508], '401': [33.77589245977012, -84.18728384482759], '402': [33.77405748322147, -84.17246732214764], '403': [33.75237457971014, -84.18155761835749], '404': [33.74069032407407, -84.18740158333333], '405': [33.894030203938115, -84.06900480028129], '406': [34.11688335319149, -83.98687565957447], '407': [33.85065366972477, -84.0903020825688], '408': [33.92507282105263, -84.13152539649123], '409': [34.01094995092024, -84.16241457668711], '410': [34.083564241691846, -84.00586979758307], '411': [33.816027242152465, -84.09232413901346], '412': [33.91267624778761, -84.18266084070795], '413': [33.8798605729927, -84.02996943430657], '414': [33.78651852200001, -84.041029364], '415': [33.85579797209302, -84.07851185581396], '416': [33.85282969187674, -83.99034996078431], '417': [34.13156016967509, -84.03382068231046], '418': [33.77299962121212, -84.24256148484848], '419': [33.74395957352941, -84.1564204852941], '420': [33.66475725742574, -84.26430840594058], '421': [33.674058572864325, -84.29398356281406], '422': [33.68084655909091, -84.15493452272729], '423': [33.908440408730165, -84.32296820238096], '424': [33.88108585714286, -84.30090144047618], '425': [33.6603279908257, -84.4134990642202], '426': [34.03883488739947, -84.39450903217158], '427': [33.811626293749995, -84.38713886875], '428': [33.77840921621621, -84.38524564864863], '429': [33.735588143540674, -84.17717176076555], '430': [33.72269457526881, -84.08823344086022], '431': [33.72435098540146, -84.14657084671532], '432': [33.71029587786259, -84.13762824427481], '433': [33.70884727936508, -84.73124380634921], '434': [33.70553384810126, -84.67782849367089], '435': [33.79301579190751, -84.64076249710983], '436': [33.85246567708333, -84.32311467708332], '437': [33.744751, -84.30241794949495], '438': [33.81991077419355, -84.19104443548387], '439': [33.92847772897196, -84.32639719626168], '440': [33.85898882008369, -84.3015848284519], '441': [33.82035875, -84.32429613709677], '442': [33.776021703703705, -84.38095974074075], '443': [33.78000410869566, -84.39140241304348], '444': [33.8168028875, -84.44397387500001], '445': [33.74564539534883, -84.40900079069768], '446': [33.65300529824561, -84.4278486140351], '447': [34.07481373809524, -84.28065020634921], '448': [33.761106446043165, -84.71534556834534], '449': [33.74136719469027, -84.75027685840709], '450': [33.8988047979798, -84.30684831818184], '451': [33.894418505791506, -84.32508495752896], '452': [33.72804886016949, -84.70909225423729], '453': [33.71688286451613, -84.75050133548388], '454': [33.943333914285716, -84.30686188095237], '455': [33.94915267592592, -84.28689239351853], '456': [33.846193055045866, -84.18735031192661], '457': [33.87262294864865, -84.24085396486485], '458': [33.85399798963731, -84.24196549222798], '459': [33.7063605186722, -84.27686227385892], '460': [33.70526964921466, -84.29047009424085], '461': [33.704195805084744, -84.2493238220339], '462': [33.692711645021646, -84.24385286147185], '463': [33.83346244966443, -84.29788425503355], '464': [33.82163804255319, -84.20764622695036], '465': [33.76665247, -84.24353917], '466': [33.778595513157896, -84.22645208552632], '467': [33.71798725925926, -84.20175076190475], '468': [33.95658850632912, -84.2619546329114], '469': [34.032325504385966, -84.27065050877194], '470': [33.70654673529412, -84.4414001764706], '471': [33.70696035359116, -84.48562997237569], '472': [33.70098316666667, -84.46794481666666], '473': [33.70462810526316, -84.50705006015036], '474': [33.95796946956522, -84.34112186086956], '475': [33.96097205142858, -84.32440758285713], '476': [33.90808291129033, -84.29232954032258], '477': [33.90484422033899, -84.25843047457627], '478': [33.88834750917431, -84.23834072018347], '479': [33.772626625641024, -84.11464122051282], '480': [33.772359240458016, -84.13836944274809], '481': [33.800758659217884, -84.19262569832402], '482': [33.695769541832675, -84.20647401992031], '483': [33.723117359154934, -84.26897204225351], '484': [33.723138697841726, -84.2621991942446], '485': [33.72516143065693, -84.23649912408759], '486': [33.80633362162162, -84.26834055405405], '487': [33.661346698005694, -84.19982832763533], '488': [33.675200455128206, -84.52205583333335], '489': [33.64022706369426, -84.50466905732483], '490': [33.6457216178344, -84.48915713375796], '491': [33.8918762826087, -84.1492662173913], '492': [33.78869571219512, -84.07404439512196], '493': [33.89830895505617, -84.22073653932584], '494': [33.827459407239814, -84.39631935294119], '495': [33.87808467931034, -84.78475797758621], '496': [33.81925137201365, -84.74179494880546], '497': [33.9899032578125, -84.88581273593749], '498': [33.90598412030075, -84.1688516992481], '499': [33.919838343915345, -84.1493819047619], '500': [33.86720828877005, -84.13191829411765], '501': [33.85879416025641, -84.14336376282051], '502': [33.89650383146068, -84.18561918539326], '503': [33.87477303508772, -84.11372662280701], '504': [33.835995122727276, -84.10756230909091], '505': [33.86814652287581, -84.23160207843137], '506': [33.755343537037035, -84.32427655555557], '507': [33.97296881395349, -84.05978844186046], '508': [33.95563772839506, -84.00449315432098], '509': [33.94021932857143, -83.99942734285715], '510': [33.93631830985915, -83.98042679577463], '511': [33.868873176470586, -84.05182990045247], '512': [33.89024352525253, -84.48716698989898], '513': [33.819531629870134, -84.52932468831169], '514': [33.802066492366414, -84.54638910687022], '515': [33.876244628, -84.66513482], '516': [34.005720418539326, -84.70223463483146], '517': [34.05370087368421, -84.56540302105263], '518': [33.84188039382239, -84.50907240540542], '519': [34.054162999999996, -84.62036249438204], '520': [33.47639040897097, -84.70344341424801], '521': [33.35281136129032, -84.70063979354839], '522': [33.32701236819407, -84.64496613153639], '523': [33.29588024819277, -84.53166876566264], '524': [33.4312645171504, -84.77706245382585], '525': [34.021359388679244, -84.59160996226414], '526': [33.965937227722776, -84.57966928712872], '527': [33.84121973170732, -84.02664568292683], '528': [33.87785785589519, -83.99570905240174], '529': [33.88322080143541, -84.09089410287082], '530': [33.90121517753623, -84.03255648913044], '531': [33.39714295515695, -84.72379073991033], '532': [33.266144752232144, -84.61893810714287], '533': [33.403267511945394, -84.76504170989762], '534': [33.781625614545455, -84.68897446909091], '535': [33.77198374789916, -84.67112664145658], '536': [33.76723558525345, -84.75246659447005], '537': [33.653057179600886, -84.83599473614191], '538': [33.97316585026738, -84.0293879144385], '539': [33.95434819685039, -84.14923470866144], '540': [33.99473976100629, -84.15894543396227], '541': [33.9332698, -84.19304334666666], '542': [33.93124712690356, -84.12558760406091], '543': [33.747748039473684, -84.95802588815789], '544': [33.68384091773779, -84.96123574550128], '545': [33.5593394619883, -84.22377837037037], '546': [33.42868230097088, -84.12590437669904], '547': [33.40439181346154, -84.20456868076923], '548': [33.4134886875, -83.99607680250001], '549': [33.79835032222222, -84.41766287777779], '550': [33.4731105216285, -84.25489132315522], '551': [33.48701434584451, -84.03598034137623], '552': [33.527017909, -84.09825757200001], '553': [33.49636809904154, -84.2646158913738], '554': [33.857753054545455, -84.47569724545451], '555': [33.85417408661417, -84.46966101968502], '556': [34.032694958847735, -84.6098091728395], '557': [33.71290230225989, -84.84678771751412], '558': [33.7476905, -84.82662164130436], '559': [33.66772664822134, -84.73792057312254], '560': [33.69271389726027, -84.72807629908677], '561': [34.09895888829787, -84.19412405851065], '562': [34.15758515363129, -84.10218770670392], '563': [34.11485449659863, -84.2449295782313], '564': [34.1344955483871, -84.13704858467742], '565': [34.10482141304348, -84.11699815838509], '566': [34.08218914452214, -84.12320047319346], '567': [34.11804632485876, -84.20916887853107], '568': [34.1909890947631, -84.11640914962592], '569': [34.196366695312506, -84.14593856249999], '570': [34.14764813043479, -84.12482019565216], '571': [34.145252663430426, -84.21973127831714], '572': [34.19372183882784, -84.18015750183149], '573': [34.19243253017242, -84.23709830603447], '574': [34.06713355, -84.14187028571428], '575': [34.17927060869565, -84.16401456086956], '576': [34.17740575254238, -84.20156111525424], '577': [34.16966566666667, -84.22682282716049], '578': [34.21471021602787, -84.20815741114984], '579': [34.00168465644172, -84.00089221472393], '580': [34.134994176282056, -84.06570804166667], '581': [33.97346440625, -84.14118309687498], '582': [33.90876934754099, -84.10552310491802], '583': [33.94752130909091, -84.12288328181819], '584': [33.90364172337278, -83.8900883816568], '585': [33.9625063109375, -83.93711395937501], '586': [34.10072183597884, -84.15667205820105], '587': [34.218817566666665, -84.23647292777777], '588': [34.13652726436782, -84.16173232183908], '589': [34.11875289610389, -84.12561227272727], '590': [34.082226085526315, -84.17390509210526], '591': [33.69255945086705, -84.14827326589595], '592': [33.842810838709674, -84.38702217741935], '593': [33.845836142857145, -84.36020869642857], '594': [33.83735923664122, -84.35246977862596], '595': [33.833328753731344, -84.35907218656716], '596': [33.90015854861112, -84.38882271527778], '597': [33.886550768, -84.372777392], '598': [33.889660676595746, -84.35733060851064], '599': [33.90479180620155, -84.3693170775194], '600': [33.97532473786408, -84.3482426699029], '601': [33.95960386440678, -84.36062983050849], '602': [33.62210971084337, -84.25026704819277], '603': [33.44626282517483, -84.17199358741259], '604': [33.61872355785124, -84.19664319008265], '605': [33.502803167286245, -84.15517099628254], '606': [33.394148490384616, -84.30702527884615], '607': [34.05028117197452, -84.4673464522293], '608': [34.03926641328414, -84.41476625830258], '609': [34.00146735344828, -84.34151850862068], '610': [33.572195015625, -84.48220386979166], '611': [33.554204779005524, -84.50065394475139], '612': [34.04728449753694, -84.37332979310344], '613': [33.58744703804348, -84.2336753478261], '614': [33.523715908376964, -84.21784168062827], '615': [33.46856494594595, -84.17909109189189], '616': [33.55053107042254, -84.22270805633804], '617': [33.771571576470585, -84.40708114117646], '618': [34.03378100606061, -84.56315413939393], '619': [33.983726361370714, -84.60325443925234], '620': [33.96727311764706, -84.63359763235293], '621': [33.601980294444445, -84.38039372222222], '622': [33.9946447712766, -84.02484819946808], '623': [34.09762484918794, -84.08590319721577], '624': [34.095713272727274, -84.053865171123], '625': [34.039275685897444, -84.0169775], '626': [34.05944175121952, -84.04487924390244], '627': [34.04500222314049, -83.95043328512396], '628': [33.57930499333333, -84.35996158666667], '629': [33.50353715384615, -84.39978181900453], '630': [34.026902187845295, -84.0069250441989], '631': [33.984489327272726, -84.0433136909091], '632': [33.99716830597015, -84.05645597761195], '633': [34.01043174615384, -84.05134569230769], '634': [33.501406619631894, -84.4080561595092], '635': [33.625043707692306, -84.38036606153845], '636': [33.60457639263804, -84.44101055214723], '637': [33.581220025316455, -84.371535721519], '638': [33.56897428301887, -84.38906579874214], '639': [33.99686496759259, -84.11459850462963], '640': [33.98629652671755, -84.14025645801527], '641': [33.948406744186045, -84.2453471782946], '642': [33.92695188596491, -84.20474883333333], '643': [33.95353555483871, -84.2484183548387], '644': [33.97032034302325, -84.12067895348837], '645': [33.542449622377625, -84.31002139160839], '646': [33.56138005882353, -84.26704870588235], '647': [33.600687514084505, -84.45196852816902], '648': [33.561488063829785, -84.35831047872341], '649': [33.60266794890511, -84.41691345985402], '650': [33.588246788235296, -84.39800586470588], '651': [33.55897208641975, -84.40708451851852], '652': [33.987011118143464, -84.23748762447256], '653': [33.97851307692308, -84.2430652008547], '654': [33.88646483529411, -84.20048065882352], '655': [33.887001435406695, -84.17669395693781], '656': [33.45849861764706, -84.34893261764707], '657': [33.478826902298856, -84.36228917241381], '658': [33.88376600000001, -84.20763406741573], '659': [33.92431111627907, -84.09261523837208], '660': [33.90133251807228, -84.13670186144579], '661': [33.94441397435898, -84.07080547008547], '662': [33.916168201612905, -84.05187436693548], '663': [34.06633975384615, -84.6447575128205], '664': [34.072533577777776, -84.62305222222221], '665': [33.81987752459016, -84.64967338797814], '666': [33.83261704651163, -84.64215779651164], '667': [33.94550866847826, -84.05596270108695], '668': [33.94466076433121, -84.09734736305732], '669': [33.95346605625, -84.03347308125], '670': [33.912081613333335, -83.94736875999999], '671': [33.919207694117645, -84.47456815294119], '672': [33.91578648717949, -84.49284523076925], '673': [33.93148351260505, -84.5046388235294], '674': [33.4709415875, -84.79378767], '675': [33.42464924096385, -84.6721631626506], '676': [33.39183736792453, -84.67303001257862], '677': [33.35400536153846, -84.8020563], '678': [33.43221704496788, -84.65629967023555], '679': [34.05926078609625, -84.4766035775401], '680': [34.046315628820956, -84.43075585152839], '681': [33.964766149532714, -84.47080111214953], '682': [33.96017946226415, -84.48835811320755], '683': [33.93201719135802, -84.46757227160494], '684': [33.94348847311828, -84.47737847849463], '685': [33.986458367346934, -84.72599179591838], '686': [33.9600069125, -84.719437175], '687': [33.96687361921708, -84.68918385409252], '688': [33.551246308724835, -84.38534346644295], '689': [33.565147133093525, -84.29465840647481], '690': [33.482999170297035, -84.3761508], '691': [33.575936741134754, -84.3824304858156], '692': [33.59282423076924, -84.42152024615385], '693': [33.503987715261964, -84.38359385193623], '694': [33.63239388700565, -84.43309933898306], '695': [33.93710459523809, -84.50403593650792], '696': [33.907736723404255, -84.47560969503547], '697': [33.899528172185434, -84.46873181456952], '698': [33.90505113333334, -84.49542], '699': [33.916291305343506, -83.98974739694656], '700': [34.0176153875969, -83.97720574418605], '701': [33.93579234285715, -84.1064166857143], '702': [33.94713861068703, -84.10481040458015], '703': [33.846708895104896, -84.70347002097903], '704': [34.064363957831326, -84.59469646987952], '705': [33.87671638918919, -84.55255184324324], '706': [33.88610289247312, -84.54320825806451], '707': [33.889518693069306, -84.69287838613862], '708': [33.867979608108115, -84.64912574324325], '709': [33.85833730666667, -84.54901874666668], '710': [33.85374906214689, -84.529955], '711': [34.063250180555556, -84.57639205555556], '712': [33.91209551497007, -84.65084575449102], '713': [33.918593039215686, -84.6136432745098], '714': [33.91226278378379, -84.69561164864865], '715': [33.92764501809955, -84.67591544343892], '716': [33.842447208510634, -83.96918169787234], '717': [33.835627195488726, -84.04376548120298], '718': [33.83015747747747, -84.06435895495498], '719': [33.81800459923664, -84.02623806488549], '720': [33.82634089380531, -83.95032449557523], '721': [33.68812935416667, -84.430633125], '722': [33.69242531481481, -84.44360947222224], '723': [33.679152983193276, -84.45205365546218], '724': [33.595869016077174, -83.94407634083602], '725': [33.509414342511754, -83.98605324378778], '726': [33.55893859693877, -83.96954910969387], '727': [33.556964691910494, -83.99785712564544], '728': [33.68725814444444, -84.46783435555555], '729': [33.663960748768474, -84.47935703940888], '730': [33.91728564909847, -84.85966706310678], '731': [34.01223687912088, -84.81003624767541], '732': [33.98636912251656, -84.7921521192053], '733': [33.885521626315786, -84.87295038157896], '734': [33.93426341723356, -84.81843412244896], '735': [33.932480696078436, -84.77218935294117], '736': [33.800948026525205, -84.81575181697613], '737': [33.81340351552795, -84.8642633152174], '738': [33.8452838029466, -84.797736106814], '739': [33.85203824679487, -84.83816726762821], '740': [34.04573790578513, -84.78644383801654], '741': [33.95336601626016, -84.75493164227642], '742': [33.843922737470166, -84.74233566348448], '743': [33.81220669168901, -84.78035090348526], '744': [33.42758680912163, -84.60981936824324], '745': [33.42047830067567, -84.58404165202703], '746': [34.019124695652174, -84.34827290217392], '747': [33.986007092378756, -84.29251083833718], '748': [33.99834993193718, -84.31527196335078], '749': [34.005564786802026, -84.2762145177665], '750': [33.76583343939394, -84.34429457575757], '751': [33.75375321999999, -84.34313256], '752': [33.758761179487166, -84.33510187179488], '753': [33.75509661842106, -84.3158255], '754': [33.73203626903554, -84.33487256345177], '755': [33.77594437931034, -84.40201416091953], '756': [33.780365263736265, -84.4233682967033], '757': [33.796369039408866, -84.46427085714286], '758': [33.684533888888886, -84.19088205698007], '759': [33.69958231962398, -84.32918811633371], '760': [33.801540168831174, -84.29424770454544], '761': [33.75596973446328, -84.12771264124294], '762': [33.79850158333334, -84.34358164583332], '763': [33.80851927878788, -84.28930923939393], '764': [33.81084435087719, -84.24553403508772], '765': [33.77580916346154, -84.3397756153846], '766': [33.76662070138889, -84.32793289583333], '767': [33.678751956262424, -84.31402102982106], '768': [33.67187023389022, -84.2317304653938], '769': [33.70273456451613, -84.36000896774192], '770': [33.720025078125, -84.359375], '771': [33.69428995488722, -84.39129781203007], '772': [33.683564006802726, -84.4079042857143], '773': [33.545795102150535, -84.67068658960575], '774': [34.02635383783784, -84.29642434797297], '775': [33.899364396825405, -84.2405743174603], '776': [33.93063587179488, -84.30457377777779], '777': [33.71106257657657, -84.46465897297297], '778': [33.76622718987342, -84.39474315189875], '779': [33.768469125, -84.42034348214285], '780': [33.70782852471483, -84.5319599771863], '781': [33.748327016064266, -84.5257326626506], '782': [33.742595125603856, -84.51613770531401], '783': [33.75729339393939, -84.42752551515153], '784': [33.757850625, -84.40148141666667], '785': [33.75827742222223, -84.37934973333333], '786': [33.75914089855072, -84.35744272463769], '787': [33.75345203225807, -84.35454516129032], '788': [33.75106122580645, -84.3643490483871], '789': [33.752220126213594, -84.39063578640778], '790': [33.74944654098361, -84.41125821311475], '791': [33.763553503703704, -84.49632052592594], '792': [33.75124336538462, -84.49854402884615], '793': [33.73280421088435, -84.49617702040815], '794': [33.72462929411765, -84.45344136974789], '795': [33.74916102580645, -84.47171758064518], '796': [33.768236508771935, -84.48295728070175], '797': [33.75070595238095, -84.43836074603173], '798': [33.74069235185185, -84.42981425925927], '799': [33.74164795588236, -84.40244569117648], '800': [33.74361515625, -84.38363284375001], '801': [33.75091757142857, -84.42361476190476], '802': [33.74141738461538, -84.38010584615387], '803': [33.741307697674415, -84.3655946511628], '804': [33.73506532467532, -84.35537035064937], '805': [33.73119906849315, -84.36966363013698], '806': [33.77804188636364, -84.50732091666666], '807': [33.764143414473686, -84.45735656578947], '808': [33.75940987962964, -84.44994300925926], '809': [33.761529, -84.43467312121211], '810': [33.7762667631579, -84.44605126315791], '811': [33.782341829787235, -84.46589], '812': [33.7280996744186, -84.38424993023256], '813': [33.71511422368421, -84.38719794736843], '814': [33.731560075, -84.4019588], '815': [33.73474492727273, -84.40986514545457], '816': [33.72700544776118, -84.44204685074627], '817': [33.72294634920635, -84.39690204761904], '818': [33.71774682692308, -84.37520313461538], '819': [33.71170817730496, -84.40997420567376], '820': [33.791131410958904, -84.48767957534247], '821': [33.804915173913045, -84.45273363354038], '822': [33.813482725, -84.36501110625], '823': [34.100422916666666, -84.55586034375], '824': [33.693436776000006, -84.41048588400001], '825': [33.59774164473684, -84.36505299561405], '826': [33.41324550297265, -84.88761342211653], '827': [33.41447941732283, -84.84482382677164], '828': [33.45849110537408, -84.6349000389884], '829': [33.73769157142857, -84.43659181632653], '830': [33.73620186206897, -84.45388065517241], '831': [33.742628333333336, -84.30143976190476]}


@app.route("/api/get_estimate", methods=['GET'])
@cross_origin()
def get_estimate():
    response = {}

    # fetch arguments passed in from request
    start = request.args.get("start", default=None)
    dest = request.args.get("dest", default=None)
    date = request.args.get("date", default=None)
    time = request.args.get("time", default=None)
    if start == "" or dest == "" or date == "" or time == "":
        response["code"] = 0
        return response

    # derive remaining features for regression model

    # get year, month, day from date
    year, month, day = date.split("-")
    # print("year:", year)
    # print("month:", month)
    # print("day:", day)

    # get day of week from year, month, day
    day_of_week = datetime.datetime(int(year), int(month), int(day)).isoweekday() + 1
    if day_of_week == 8:
        day_of_week = 1
    # print("day of week:", day_of_week)

    # get hour bucket from time
    hour = int(time.split(":")[0])
    if hour >= 0 and hour < 7:
        hour_bucket = 0
    elif hour >= 7 and hour < 10:
        hour_bucket = 1
    elif hour >= 10 and hour < 16:
        hour_bucket = 2
    elif hour >= 16 and hour < 19:
        hour_bucket = 3
    else:
        hour_bucket = 4
    # print("hour bucket:", hour_bucket)

    # get starting movement id from start
    try:
        # given a census tract
        _ = float(start)
        # print("tract id given for start")
        start_id = get_movement_id(start)
        start_coords = coordinate_mapping[start_id]
    except:
        # given an address
        # print("address given for start")
        start_coords = get_coordinates(start)
        start_id = get_census_tract(start)
        start_id = get_movement_id(start_id)
        # print("START ID", start_id)
    if start_coords == None:
        response["code"] = 0
        return response
    # print("start coords:", start_coords)

    # get destination movement id from dest
    try:
        # given a census tract
        _ = float(dest)
        # print("tract id given for dest")
        dest_id = get_movement_id(dest)
        dest_coords = coordinate_mapping[dest_id]
    except:
        # given an address
        # print("address given for dest")
        dest_coords = get_coordinates(dest)
        dest_id = get_census_tract(dest)
        dest_id = get_movement_id(dest_id)
    if dest_coords == None:
        response["code"] = 0
        return response
    # print("dest coords:", dest_coords)

    distance = haversine(start_coords[0], start_coords[1], dest_coords[0], dest_coords[1])
    
    # get weather (temp, precip, windspeed, snow_fall, snowdepth) from date and time
    temp, precip, wind_speed = get_weather(date, time + ":00")
    # print("temp:", temp)
    # print("precip:", precip)
    # print("wind speed:", wind_speed)

    # instantiate regression model
    reg = Uber_reg()
    reg.load_model()

    data = [(distance - reg.distance_mean) / (reg.distance_max - reg.distance_min), 
            (day_of_week - reg.day_of_week_mean) / (reg.day_of_week_max - reg.day_of_week_min), 
            (hour_bucket - reg.hour_bucket_mean) / (reg.hour_bucket_max - reg.hour_bucket_min), 
            (temp - reg.temp_mean) / (reg.temp_max - reg.temp_min), 
            (precip - reg.precip_mean) / (reg.precip_max - reg.precip_min), 
            (wind_speed - reg.wind_speed_mean) / (reg.wind_speed_max - reg.wind_speed_min)]

    # run input through model
    prediction = round(reg.predict_sample(data) ** 1.3)
    minutes = prediction // 60
    seconds = prediction % 60
    travel_time = str(minutes) + " minutes, " + str(seconds) + " seconds"    

    # print(data)
    # print(prediction)
    response["code"] = 1
    response["prediction"] = travel_time
    response["start_id"] = start_id
    response["dest_id"] = dest_id
    # print(response)
    return response


def parse_address(address):
    parsed_address = {"street": "", "city": ""}
    parsed = usaddress.parse(address)
    # print("first parsed address:", parsed)
    for element in parsed:
        if element[1] == "AddressNumber" or element[1] == "StreetName" or element[1] == "StreetNamePostType":
            parsed_address["street"] += (element[0] + " ")
        elif element[1] == "PlaceName":
            parsed_address["city"] += (element[0] + " ")
        elif element[1] == "StateName":
            parsed_address["state"] = element[0]
        elif element[1] == "ZipCode":
            parsed_address["zip"] = element[0]
    return parsed_address

def get_census_tract(address):
    parsed_address = parse_address(address)
    # print("second parsed address:", parsed_address)
    benchmark = "4"
    vintage = "410"
    url = "https://geocoding.geo.census.gov/geocoder/geographies/address?street=" + parsed_address["street"] + "&city=" + parsed_address["city"] + "&state=" + parsed_address["state"] + "&zip=" + parsed_address["zip"] + "&benchmark=" + benchmark + "&vintage=" + vintage + "&format=json"
    response = requests.get(url).json()
    if len(response["result"]["addressMatches"]) > 0:
        tract = response["result"]["addressMatches"][0]["geographies"]["Census Tracts"][0]["TRACT"]
    else:
        tract = None
    # print(tract)
    return tract

def get_movement_id(tract):
    for pair in census_mapping:
        if pair[1] == tract:
            return pair[0]
    return None

def get_coordinates(address):
    loc = Nominatim(user_agent="GetLoc")
    getLoc = loc.geocode(address)
    if getLoc == None:
        return None
    lat, lon = getLoc.latitude, getLoc.longitude
    return (lat, lon)

def get_census(lat, lon):
    url = "https://geo.fcc.gov/api/census/block/find?"+"lat="+str(lat)+"&lon="+str(lon)
    response = requests.get(url).json()
    return response['results']

def get_weather(date, time):
    datetime = date + 'T' + time
    url = 'https://weather.visualcrossing.com/VisualCrossingWebServices/rest/services/timeline/Atlanta%2CGA/' + datetime + '?key=V63Z8RRDP4WQ2KUS3CTK2T5G9&contentType=json'
    weather_data = requests.get(url).json()
    # Parse the results as JSON
    # weather_data = json.loads(ResultBytes.read().decode('utf-8'))
    h = int(time.split(":")[0])
    try:
        temp = weather_data['days'][0]['hours'][h]['temp']
        precip = weather_data['days'][0]['hours'][h]['precip']
        windspeed = weather_data['days'][0]['hours'][h]['windspeed']
    except:
        temp = weather_data['days'][0]['temp']
        precip = weather_data['days'][0]['precip']
        if precip == None:
            precip = 0.0
        windspeed = weather_data['days'][0]['windspeed']
        if windspeed == None:
            windspeed = 0.0
    return temp, precip, windspeed

def haversine(lat1, lon1, lat2, lon2):
    """
    Calculate the great circle distance in kilometers between two points 
    on the earth (specified in decimal degrees)
    """
    # convert decimal degrees to radians 
    lon1, lat1, lon2, lat2 = map(radians, [lon1, lat1, lon2, lat2])

    # haversine formula 
    dlon = lon2 - lon1 
    dlat = lat2 - lat1 
    a = sin(dlat/2)**2 + cos(lat1) * cos(lat2) * sin(dlon/2)**2
    c = 2 * asin(sqrt(a)) 
    r = 6371 # Radius of earth in kilometers. Use 3956 for miles. Determines return value units.
    return c * r
